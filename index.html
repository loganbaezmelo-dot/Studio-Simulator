<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Simulator Pro</title>
    <!-- Dependencies -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap');
        
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: black;
        }

        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #262626; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #404040; }

        /* Markdown Styling for Chat */
        .markdown-content h1, .markdown-content h2, .markdown-content h3 { font-weight: 700; margin-bottom: 0.5rem; }
        .markdown-content p { margin-bottom: 0.75rem; }
        .markdown-content p:last-child { margin-bottom: 0; }
        .markdown-content ul, .markdown-content ol { margin-bottom: 0.75rem; padding-left: 1.25rem; }
        .markdown-content ul { list-style-type: disc; }
        .markdown-content ol { list-style-type: decimal; }
        .markdown-content li { margin-bottom: 0.25rem; }
        .markdown-content strong { font-weight: 700; color: #fff; }
        .markdown-content code { background: #1a1a1a; padding: 0.1rem 0.3rem; border-radius: 0.2rem; font-family: monospace; }
    </style>
</head>
<body class="text-neutral-100 overflow-hidden">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const App = () => {
            // --- GAME STATE ---
            const [subscribers, setSubscribers] = useState(0);
            const [totalViews, setTotalViews] = useState(0);
            const [channelPoints, setChannelPoints] = useState(0);
            const [videosMade, setVideosMade] = useState(0);
            const [lastAction, setLastAction] = useState({ text: "System online. Ready for upload.", type: 'neutral' });
            const [upgrades, setUpgrades] = useState({ camera: 0, editing: 0, marketing: 0 });
            const [claimedAwards, setClaimedAwards] = useState([]);

            // --- UI & AI STATE ---
            const [showSettings, setShowSettings] = useState(false);
            const [apiKey, setApiKey] = useState("");
            const [chatHistory, setChatHistory] = useState([]);
            const [chatInput, setChatInput] = useState("");
            const [isAiLoading, setIsAiLoading] = useState(false);
            
            const chatContainerRef = useRef(null);

            const CONFIG = {
                BASE_VIEWS: [20, 70],
                BASE_SUBS: [1, 5],
                COSTS: { camera: 50, editing: 75, marketing: 100 },
                SCALING: { camera: 1.5, editing: 1.6, marketing: 1.7 },
                BONUSES: { views: 0.12, subs: 0.10, cp: 0.05 }
            };

            const awardsList = [
                { id: 'silver', name: "Silver Play Button", milestone: 100000, bonus: 5000, emoji: "ðŸ¥ˆ" },
                { id: 'gold', name: "Gold Play Button", milestone: 1000000, bonus: 25000, emoji: "ðŸ¥‡" },
                { id: 'diamond', name: "Diamond Play Button", milestone: 10000000, bonus: 100000, emoji: "ðŸ’Ž" },
                { id: 'rareCustom', name: "Rare Custom Play Button", milestone: 20000000, bonus: 150000, emoji: "âœ¨" },
                { id: 'custom', name: "Custom Play Button", milestone: 50000000, bonus: 250000, emoji: "ðŸŒŸ" },
                { id: 'redDiamond', name: "Red Diamond Play Button", milestone: 100000000, bonus: 500000, emoji: "ðŸ”´" },
            ];

            // Handle Lucide Icons on every render update
            useEffect(() => {
                if (window.lucide) {
                    window.lucide.createIcons();
                }
            });

            const getCost = (type) => Math.floor(CONFIG.COSTS[type] * Math.pow(CONFIG.SCALING[type], upgrades[type]));

            const recordVideo = () => {
                const vNum = videosMade + 1;
                const baseViews = Math.floor(Math.random() * (CONFIG.BASE_VIEWS[1] - CONFIG.BASE_VIEWS[0] + 1)) + CONFIG.BASE_VIEWS[0];
                const baseSubs = Math.floor(Math.random() * (CONFIG.BASE_SUBS[1] - CONFIG.BASE_SUBS[0] + 1)) + CONFIG.BASE_SUBS[0];
                
                const views = Math.floor(baseViews * (1 + (upgrades.camera * CONFIG.BONUSES.views)));
                const subs = Math.floor(baseSubs * (1 + (upgrades.editing * CONFIG.BONUSES.subs)));
                const points = Math.floor(views * (1 + (upgrades.marketing * CONFIG.BONUSES.cp)));
                
                setVideosMade(vNum);
                setTotalViews(v => v + views);
                setSubscribers(s => s + subs);
                setChannelPoints(p => p + points);
                setLastAction({ 
                    text: `Video #${vNum} published: +${views.toLocaleString()} views, +${subs.toLocaleString()} subs.`, 
                    type: 'success' 
                });
            };

            const buyUpgrade = (type) => {
                const cost = getCost(type);
                if (channelPoints >= cost) {
                    setChannelPoints(p => p - cost);
                    setUpgrades(prev => ({ ...prev, [type]: prev[type] + 1 }));
                    setLastAction({ text: `${type.toUpperCase()} optimization complete.`, type: 'upgrade' });
                }
            };

            const claimAward = (award) => {
                if (subscribers >= award.milestone && !claimedAwards.includes(award.id)) {
                    setClaimedAwards([...claimedAwards, award.id]);
                    setChannelPoints(p => p + award.bonus);
                    setLastAction({ text: `Milestone reached: ${award.name} acquired.`, type: 'award' });
                }
            };

            const sendMessage = async (e) => {
                e.preventDefault();
                if (!chatInput.trim() || isAiLoading) return;
                
                const userText = chatInput.trim();
                setChatHistory(prev => [...prev, { role: 'user', content: userText }]);
                setChatInput("");
                setIsAiLoading(true);

                const systemPrompt = `You are a professional YouTube Growth Consultant. 
                Current Stats: ${subscribers} subs, ${totalViews} views, ${videosMade} videos. 
                Tech: Camera Lvl ${upgrades.camera}, Editing Lvl ${upgrades.editing}, Marketing Lvl ${upgrades.marketing}.
                Strategy: Provide professional, concise advice using Markdown for formatting (bolding, lists). No emojis. Focus on the next logical growth step.`;

                try {
                    if (!apiKey) {
                        setChatHistory(prev => [...prev, { role: 'ai', content: "Strategist requires a **Gemini API Key** in Settings to analyze your channel." }]);
                        setIsAiLoading(false);
                        return;
                    }
                    
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: userText }] }],
                            systemInstruction: { parts: [{ text: systemPrompt }] }
                        })
                    });

                    const data = await response.json();
                    const text = data.candidates?.[0]?.content?.parts?.[0]?.text || "Consultation unavailable at this time.";
                    setChatHistory(prev => [...prev, { role: 'ai', content: text }]);
                } catch (err) {
                    setChatHistory(prev => [...prev, { role: 'ai', content: "Connection error. Please verify your API key and network." }]);
                } finally {
                    setIsAiLoading(false);
                }
            };

            useEffect(() => {
                if (chatContainerRef.current) {
                    chatContainerRef.current.scrollTop = chatContainerRef.current.scrollHeight;
                }
            }, [chatHistory, isAiLoading]);

            const est = {
                views: [
                    Math.floor(CONFIG.BASE_VIEWS[0] * (1 + (upgrades.camera * CONFIG.BONUSES.views))),
                    Math.floor(CONFIG.BASE_VIEWS[1] * (1 + (upgrades.camera * CONFIG.BONUSES.views)))
                ],
                subs: [
                    Math.floor(CONFIG.BASE_SUBS[0] * (1 + (upgrades.editing * CONFIG.BONUSES.subs))),
                    Math.floor(CONFIG.BASE_SUBS[1] * (1 + (upgrades.editing * CONFIG.BONUSES.subs)))
                ]
            };

            return (
                <div className="flex flex-col md:flex-row h-screen w-full bg-black text-neutral-100 overflow-hidden select-none">
                    
                    {/* Sidebar: Analytics */}
                    <aside className="w-full md:w-80 h-auto md:h-full bg-neutral-900 border-b md:border-b-0 md:border-r border-neutral-800 flex flex-col shrink-0 z-20">
                        <div className="p-6 border-b border-neutral-800 flex justify-between items-center bg-neutral-900">
                            <div className="flex items-center gap-2">
                                <div className="bg-red-600 p-1.5 rounded-sm"><i data-lucide="video" className="text-white w-4 h-4"></i></div>
                                <h1 className="font-bold text-lg tracking-tight uppercase">Studio</h1>
                            </div>
                            <button onClick={() => setShowSettings(true)} className="text-neutral-500 hover:text-white transition-colors">
                                <i data-lucide="settings" className="w-5 h-5"></i>
                            </button>
                        </div>

                        <div className="flex-1 overflow-y-auto p-4 space-y-8 custom-scrollbar">
                            <section>
                                <h3 className="text-[10px] uppercase tracking-widest text-neutral-500 font-bold mb-3 flex items-center gap-2">
                                    <i data-lucide="bar-chart-3" className="w-3 h-3"></i> Analytics
                                </h3>
                                <div className="space-y-1">
                                    <StatRow label="Subscribers" value={subscribers.toLocaleString()} icon="users" />
                                    <StatRow label="Views" value={totalViews.toLocaleString()} icon="eye" />
                                    <StatRow label="Points" value={channelPoints.toLocaleString()} icon="trending-up" color="text-amber-400" />
                                    <StatRow label="Videos" value={videosMade.toLocaleString()} icon="video" />
                                </div>
                            </section>

                            <section>
                                <h3 className="text-[10px] uppercase tracking-widest text-neutral-500 font-bold mb-3 flex items-center gap-2">
                                    <i data-lucide="award" className="w-3 h-3"></i> Milestones
                                </h3>
                                <div className="space-y-2">
                                    {awardsList.map(award => (
                                        <button 
                                            key={award.id}
                                            onClick={() => claimAward(award)}
                                            disabled={subscribers < award.milestone || claimedAwards.includes(award.id)}
                                            className={`w-full text-left p-3 rounded border transition-all flex items-center justify-between group ${
                                                claimedAwards.includes(award.id) ? 'bg-emerald-900/10 border-emerald-500/20' : 
                                                subscribers >= award.milestone ? 'bg-amber-900/20 border-amber-500/50 hover:bg-amber-500/30' : 
                                                'bg-neutral-800/20 border-neutral-700/50 opacity-40'
                                            }`}
                                        >
                                            <div className="flex items-center gap-3">
                                                <span className="text-xl">{award.emoji}</span>
                                                <div>
                                                    <p className="text-[10px] font-bold uppercase">{award.name}</p>
                                                    <p className="text-[9px] text-neutral-500 italic">{award.milestone.toLocaleString()} subs</p>
                                                </div>
                                            </div>
                                        </button>
                                    ))}
                                </div>
                            </section>
                        </div>
                    </aside>

                    {/* Main Content */}
                    <main className="flex-1 flex flex-col min-h-0 bg-neutral-950">
                        
                        {/* Workstation Area */}
                        <div className="flex-1 overflow-y-auto p-6 md:p-12 space-y-12 custom-scrollbar">
                            <div className="flex flex-col items-center space-y-8 max-w-2xl mx-auto">
                                <header className="text-center space-y-2">
                                    <h2 className="text-3xl font-black tracking-tighter uppercase italic">Workstation</h2>
                                    <div className="h-1 w-16 bg-red-600 mx-auto" />
                                </header>

                                <div className="w-full grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div className="bg-neutral-900 border border-neutral-800 p-5 rounded">
                                        <p className="text-[9px] uppercase font-black text-neutral-500 mb-4 tracking-widest text-center">Algorithm Index</p>
                                        <div className="grid grid-cols-2 gap-4 text-center">
                                            <div>
                                                <p className="text-[9px] text-neutral-400 uppercase tracking-tighter font-bold mb-1">Reach</p>
                                                <p className="text-xl font-black tracking-tighter">{est.views[0]} - {est.views[1]}</p>
                                            </div>
                                            <div>
                                                <p className="text-[9px] text-neutral-400 uppercase tracking-tighter font-bold mb-1">Subs</p>
                                                <p className="text-xl font-black tracking-tighter text-emerald-500">{est.subs[0]} - {est.subs[1]}</p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <button 
                                        onClick={recordVideo}
                                        className="bg-red-600 hover:bg-red-500 active:bg-red-700 transition-all rounded flex flex-col items-center justify-center font-black text-lg tracking-tighter border-b-4 border-red-800 py-6"
                                    >
                                        <i data-lucide="play" className="mb-1 w-7 h-7"></i>
                                        PUBLISH CONTENT
                                    </button>
                                </div>

                                <div className="w-full p-4 border border-neutral-800 bg-neutral-900/50 text-[10px] font-bold uppercase tracking-widest flex items-center gap-3">
                                    <i data-lucide="chevron-right" className="text-red-500 w-4 h-4"></i>
                                    {lastAction.text}
                                </div>

                                <div className="w-full space-y-3 pb-8">
                                    <h3 className="text-[9px] font-black text-neutral-500 uppercase tracking-[0.2em]">Upgrade Protocol</h3>
                                    <UpgradeRow title="Visuals" level={upgrades.camera} desc="Boost view count" cost={getCost('camera')} icon="camera" canAfford={channelPoints >= getCost('camera')} onBuy={() => buyUpgrade('camera')} />
                                    <UpgradeRow title="Process" level={upgrades.editing} desc="Boost conversion" cost={getCost('editing')} icon="edit" canAfford={channelPoints >= getCost('editing')} onBuy={() => buyUpgrade('editing')} />
                                    <UpgradeRow title="Social" level={upgrades.marketing} desc="Boost CP yield" cost={getCost('marketing')} icon="trending-up" canAfford={channelPoints >= getCost('marketing')} onBuy={() => buyUpgrade('marketing')} />
                                </div>
                            </div>
                        </div>

                        {/* AI Strategist Chat Panel */}
                        <section className="h-80 md:h-[350px] bg-neutral-900 border-t border-neutral-800 flex flex-col shrink-0 shadow-2xl z-10">
                            <div className="px-6 py-2 bg-black/40 border-b border-neutral-800 flex items-center gap-2">
                                <div className="w-1.5 h-1.5 bg-blue-500 rounded-full" />
                                <h3 className="text-[9px] font-black uppercase tracking-widest text-neutral-400">Strategist Consultation</h3>
                            </div>

                            <div ref={chatContainerRef} className="flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar bg-neutral-950/30">
                                {chatHistory.length === 0 && (
                                    <p className="text-center text-neutral-600 text-[10px] uppercase font-bold py-10 tracking-widest italic">Awaiting Analysis Query</p>
                                )}
                                {chatHistory.map((msg, i) => (
                                    <div key={i} className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}>
                                        <div className={`max-w-[85%] p-3 text-[11px] leading-relaxed border rounded-sm ${
                                            msg.role === 'user' ? 'bg-blue-600 border-blue-500 text-white font-bold' : 'bg-neutral-800 border-neutral-700 text-neutral-200'
                                        }`}>
                                            <div 
                                                className="markdown-content" 
                                                dangerouslySetInnerHTML={{ __html: marked.parse(msg.content) }} 
                                            />
                                        </div>
                                    </div>
                                ))}
                                {isAiLoading && (
                                    <div className="flex justify-start">
                                        <div className="bg-neutral-800 border border-neutral-700 p-3 flex gap-1">
                                            <span className="w-1 h-1 bg-neutral-500 animate-pulse" />
                                            <span className="w-1 h-1 bg-neutral-500 animate-pulse [animation-delay:0.2s]" />
                                            <span className="w-1 h-1 bg-neutral-500 animate-pulse [animation-delay:0.4s]" />
                                        </div>
                                    </div>
                                )}
                            </div>

                            <form onSubmit={sendMessage} className="p-3 bg-black border-t border-neutral-800 flex gap-2">
                                <input 
                                    type="text" 
                                    value={chatInput}
                                    onChange={(e) => setChatInput(e.target.value)}
                                    placeholder="Query growth strategy..."
                                    className="flex-1 bg-neutral-800 border border-neutral-700 rounded-sm px-4 py-2 text-[11px] outline-none focus:border-blue-500 transition-colors"
                                />
                                <button 
                                    type="submit" 
                                    disabled={isAiLoading || !chatInput.trim()}
                                    className="px-6 bg-blue-600 hover:bg-blue-500 disabled:bg-neutral-800 disabled:text-neutral-500 font-black text-[10px] uppercase tracking-widest transition-colors"
                                >
                                    Send
                                </button>
                            </form>
                        </section>
                    </main>

                    {/* Settings Modal */}
                    {showSettings && (
                        <div className="fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-[100] backdrop-blur-sm">
                            <div className="bg-neutral-900 border border-neutral-800 w-full max-w-sm p-8 space-y-8 shadow-2xl">
                                <div className="flex justify-between items-center border-b border-neutral-800 pb-4">
                                    <h3 className="font-black text-xs uppercase tracking-[0.2em]">Config</h3>
                                    <button onClick={() => setShowSettings(false)} className="text-neutral-500 hover:text-white">
                                        <i data-lucide="x" className="w-5 h-5"></i>
                                    </button>
                                </div>
                                <div className="space-y-6">
                                    <div>
                                        <label className="block text-[9px] font-black text-neutral-500 uppercase tracking-widest mb-3 tracking-widest">Gemini API Key</label>
                                        <input 
                                            type="password" 
                                            value={apiKey}
                                            onChange={(e) => setApiKey(e.target.value)}
                                            placeholder="INPUT KEY"
                                            className="w-full bg-black border border-neutral-800 px-4 py-3 text-[11px] outline-none focus:border-blue-500 tracking-widest placeholder:text-neutral-700"
                                        />
                                        <p className="text-[10px] text-neutral-600 mt-4 leading-relaxed font-medium italic">Integration allows the AI to parse your live data. Key is never stored.</p>
                                    </div>
                                    <button onClick={() => setShowSettings(false)} className="w-full py-3 bg-blue-600 hover:bg-blue-500 font-black text-[10px] uppercase tracking-widest transition-all">Apply Settings</button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // UI Stat Component
        const StatRow = ({ label, value, icon, color = "text-neutral-200" }) => (
            <div className="flex items-center justify-between p-2.5 rounded hover:bg-neutral-800/20 transition-colors">
                <div className="flex items-center gap-2 text-neutral-500 uppercase font-black text-[9px] tracking-tight">
                    <i data-lucide={icon} className="w-3.5 h-3.5"></i> <span>{label}</span>
                </div>
                <span className={`text-[11px] font-black tracking-tight ${color}`}>{value}</span>
            </div>
        );

        // UI Upgrade Row Component
        const UpgradeRow = ({ title, level, desc, cost, icon, canAfford, onBuy }) => (
            <div className="bg-neutral-900 border border-neutral-800 p-4 rounded flex items-center justify-between group">
                <div className="flex items-center gap-4">
                    <div className="p-2.5 bg-neutral-800 text-neutral-500 group-hover:text-red-500 transition-colors">
                        <i data-lucide={icon} className="w-5 h-5"></i>
                    </div>
                    <div>
                        <p className="text-[10px] font-black uppercase tracking-tight">{title} <span className="text-neutral-600 text-[8px] ml-1 tracking-widest">L{level}</span></p>
                        <p className="text-[8px] font-bold text-neutral-500 uppercase tracking-tighter">{desc}</p>
                    </div>
                </div>
                <button 
                    onClick={onBuy} 
                    disabled={!canAfford} 
                    className={`px-4 py-2.5 font-black text-[9px] uppercase tracking-widest transition-all ${
                        canAfford ? 'bg-white text-black hover:bg-neutral-200' : 'bg-neutral-800 text-neutral-600 opacity-50'
                    }`}
                >
                    {cost.toLocaleString()} CP
                </button>
            </div>
        );

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

